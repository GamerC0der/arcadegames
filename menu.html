<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Arcade Menu</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #000;
            margin: 0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            user-select: none;
        }
        #game-container {
            position: relative;
            width: 512px;
            height: 512px;
        }
        canvas {
            width: 100%;
            height: 100%;
            image-rendering: pixelated;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
        }
        #ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .menu-item {
            font-family: 'Press Start 2P', cursive;
            color: #555;
            font-size: 20px;
            margin: 20px 0;
            text-align: center;
            text-shadow: 2px 2px #000;
        }
        .menu-item.selected {
            color: #fff;
            text-shadow: 0 0 10px #fff;
        }
        h1 {
            font-family: 'Press Start 2P', cursive;
            color: #29ADFF;
            font-size: 40px;
            margin-bottom: 60px;
            text-shadow: 4px 4px #FF004D;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="ui-layer">
            <h1>ARCADE</h1>
            <div id="item-0" class="menu-item selected">Space Ailen</div>
            <div id="item-1" class="menu-item">Bounce</div>
            <div id="item-2" class="menu-item">Snake</div>
            <div id="item-3" class="menu-item">Space</div>
            <div id="item-4" class="menu-item">Quit</div>
        </div>
    </div>
    <script type="module">
        import * as THREE from 'https://unpkg.com/three@0.160.0/build/three.module.js';

        const SCENE_WIDTH = 128;
        const SCENE_HEIGHT = 128;
        
        const COLORS = {
            black: 0x000000,
            white: 0xFFFFFF,
            red: 0xFF004D,
            green: 0x00E436,
            blue: 0x29ADFF,
            yellow: 0xFFEC27,
            orange: 0xFFA300,
            pink: 0xFF77A8,
            purple: 0x83769c,
            cyan: 0x29ADFF
        };

        const INVADER_SHAPE = [
            [0,0,1,0,0],
            [0,1,1,1,0],
            [1,1,1,1,1],
            [1,0,1,0,1],
            [0,1,0,1,0]
        ];

        const BALL_SHAPE = [
            [0,1,1,1,0],
            [1,1,1,1,1],
            [1,1,1,1,1],
            [1,1,1,1,1],
            [0,1,1,1,0]
        ];

        const SNAKE_SHAPE = [
            [0,1,1,1,0],
            [1,0,0,0,0],
            [0,1,1,1,0],
            [0,0,0,0,1],
            [0,1,1,1,0]
        ];

        const X_SHAPE = [
            [1,0,0,0,1],
            [0,1,0,1,0],
            [0,0,1,0,0],
            [0,1,0,1,0],
            [1,0,0,0,1]
        ];

        const SHIP_SHAPE = [
            [0,0,1,0,0],
            [0,1,1,1,0],
            [1,0,1,0,1],
            [1,0,0,0,1],
            [1,0,0,0,1]
        ];

        let scene, camera, renderer;
        let selectedIndex = 0;
        const items = ['Space Ailen', 'Bounce', 'Snake', 'Space', 'Quit'];
        let iconMesh;

        function init() {
            const container = document.getElementById('game-container');
            
            scene = new THREE.Scene();
            scene.background = new THREE.Color(COLORS.black);

            camera = new THREE.PerspectiveCamera(60, 1, 0.1, 1000);
            camera.position.set(0, 0, 40);
            camera.lookAt(0, 0, 0);

            renderer = new THREE.WebGLRenderer({ antialias: false, powerPreference: "high-performance" });
            renderer.setSize(SCENE_WIDTH, SCENE_HEIGHT, false);
            container.appendChild(renderer.domElement);

            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            
            const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
            dirLight.position.set(10, 20, 10);
            scene.add(dirLight);

            createStars();
            createIcon();

            window.addEventListener('keydown', handleInput);
            renderer.setAnimationLoop(animate);
            
            updateMenuUI();
        }

        function createStars() {
            const geometry = new THREE.BufferGeometry();
            const vertices = [];
            for (let i = 0; i < 200; i++) {
                vertices.push(
                    (Math.random() - 0.5) * 200,
                    (Math.random() - 0.5) * 100,
                    (Math.random() - 0.5) * 200
                );
            }
            geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
            const material = new THREE.PointsMaterial({ color: COLORS.white, size: 0.5 });
            const stars = new THREE.Points(geometry, material);
            scene.add(stars);
        }

        function createVoxelSprite(matrix, color, scale = 1) {
            const group = new THREE.Group();
            const geo = new THREE.BoxGeometry(1, 1, 1);
            const mat = new THREE.MeshLambertMaterial({ color: color });
            
            matrix.forEach((row, y) => {
                row.forEach((val, x) => {
                    if (val) {
                        const mesh = new THREE.Mesh(geo, mat);
                        mesh.position.set(x - row.length/2, -y + matrix.length/2, 0);
                        group.add(mesh);
                    }
                });
            });
            group.scale.set(scale, scale, scale);
            return group;
        }

        function createIcon() {
            if (iconMesh) scene.remove(iconMesh);
            
            let shape = INVADER_SHAPE;
            let color = COLORS.green;
            let scale = 4;

            if (selectedIndex === 1) {
                shape = BALL_SHAPE;
                color = COLORS.cyan;
            } else if (selectedIndex === 2) {
                shape = SNAKE_SHAPE;
                color = COLORS.green;
            } else if (selectedIndex === 3) {
                shape = SHIP_SHAPE;
                color = COLORS.blue;
            } else if (selectedIndex === 4) {
                shape = X_SHAPE;
                color = COLORS.red;
            } else {
                color = COLORS.purple;
            }

            iconMesh = createVoxelSprite(shape, color, scale);
            scene.add(iconMesh);
        }

        function handleInput(e) {
            if (e.key === 'ArrowUp') {
                selectedIndex = (selectedIndex - 1 + items.length) % items.length;
                updateMenuUI();
            } else if (e.key === 'ArrowDown') {
                selectedIndex = (selectedIndex + 1) % items.length;
                updateMenuUI();
            } else if (e.key === 'Enter' || e.key === ' ') {
                selectItem();
            }
        }

        function updateMenuUI() {
            items.forEach((item, index) => {
                const el = document.getElementById(`item-${index}`);
                if (index === selectedIndex) {
                    el.classList.add('selected');
                } else {
                    el.classList.remove('selected');
                }
            });

            if (iconMesh) {
                const colors = [COLORS.green, COLORS.cyan, COLORS.green, COLORS.blue, COLORS.red];
                const color = colors[selectedIndex] || COLORS.white;
                iconMesh.children.forEach(c => c.material.color.setHex(color));
            }
        }

        function selectItem() {
            if (selectedIndex === 0) {
                window.location.href = 'index.html';
            } else if (selectedIndex === 1) {
                window.location.href = 'bounce.html';
            } else if (selectedIndex === 2) {
                window.location.href = 'snake.html';
            } else if (selectedIndex === 3) {
                window.location.href = 'asteroids.html';
            } else {
                document.body.innerHTML = '<div style="color:white; font-family:monospace; text-align:center; margin-top: 20%;"><h1>BYE!</h1></div>';
            }
        }

        function animate(time) {
            if (iconMesh) {
                iconMesh.rotation.y = time * 0.0005;
                iconMesh.rotation.z = Math.sin(time * 0.001) * 0.1;
                iconMesh.position.set(0, 10, -20); 
            }
            renderer.render(scene, camera);
        }

        init();
    </script>
</body>
</html>